import pandas as pd
import ipywidgets as widgets
from IPython.display import display, clear_output

# Load data
excel_file = 'path/to/your/excel_file.xlsx'
df = pd.read_excel(excel_file, sheet_name='Sheet1')

# Unique values for filters
countries = ['All'] + df['Country'].unique().tolist()
portfolios = ['All'] + df['Portfolio'].unique().tolist()

# Widgets
country_dropdown = widgets.Dropdown(
    options=countries,
    value='All',
    description='Country:'
)

portfolio_dropdown = widgets.Dropdown(
    options=portfolios,
    value='All',
    description='Portfolio:'
)

submit_button = widgets.Button(
    description='Filter Data',
    button_style='primary'
)

# Output area
output = widgets.Output()

# Define callback function
def on_button_click(b):
    # Get selected values
    selected_country = country_dropdown.value
    selected_portfolio = portfolio_dropdown.value
    
    # Filter data
    filtered_data = df.copy()
    if selected_country != 'All':
        filtered_data = filtered_data[filtered_data['Country'] == selected_country]
    if selected_portfolio != 'All':
        filtered_data = filtered_data[filtered_data['Portfolio'] == selected_portfolio]
    
    # Display filtered data
    with output:
        clear_output(wait=True)
        display(filtered_data)

# Set up the button click event
submit_button.on_click(on_button_click)

# Display widgets
display(country_dropdown, portfolio_dropdown, submit_button, output)
